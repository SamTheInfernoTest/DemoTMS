import{a as B,u as M,j as e,r as n,c as O}from"./index-Ci3233eU.js";import{B as N,Q as V}from"./react-toastify.esm-CZEk71Ew.js";import{R as W}from"./index-A-ryTlbI.js";function C({setTaskViewer:t,setTaskInfo:x,info:o}){const{isoToLocal:h}=B(),{baseApiUrl:f}=M();return e.jsxs("div",{id:o?.id,className:"relative flex flex-col shadow-md bg-clip-border rounded-xl w-80 h-[23rem] bg-lightPanel dark:bg-darkPanel",children:[e.jsx("div",{className:"relative mx-4 mt-4 overflow-hidden bg-clip-border rounded-xl h-44",children:e.jsx("img",{src:o?.task_image?`${f}${o?.task_image}`:`https://picsum.photos/seed/${o?.id}/200`,alt:"card-image",className:"object-cover w-full h-full"})}),e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex justify-between mb-2 gap-1",children:[e.jsx("p",{className:"block font-sans text-base antialiased font-medium leading-relaxed text-blue-gray-900",children:o?.subject}),e.jsxs("p",{className:"block font-sans text-base antialiased font-medium leading-relaxed text-blue-gray-900",children:["by ",o?.assignor]})]}),e.jsx("p",{className:"block font-sans text-lg antialiased font-normal leading-normal  opacity-75",children:o?.title})]}),e.jsxs("div",{className:"p-2 pt-0 absolute bottom-0 w-80 flex justify-between",children:[e.jsxs("div",{className:"my-auto font-semibold ",children:["ðŸ•’",h(o?.due_date).split(" ")[0]]}),e.jsx("button",{className:" select-none font-sans font-bold text-center uppercase transition-all disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none text-lg py-1 px-6 rounded-2xl shadow-gray-900/10 hover:shadow-gray-900/20 focus:opacity-[0.85] active:opacity-[0.85] active:shadow-none block bg-blue-gray-900/10 text-blue-gray-900 shadow-none hover:scale-105 hover:shadow-none focus:scale-105 focus:shadow-none active:scale-100 dark:bg-lightButton bg-[#0077B6] text-darkText ",type:"button",onClick:()=>{t(!0),x(o)},children:"Open"})]})]})}function P({info:t,setTaskViewer:x,submittedTask:o}){const{baseApiUrl:h}=M(),{isoToLocal:f,uid:p,axiosSecure:E}=B(),[y,j]=n.useState(!1);n.useEffect(()=>{o[t?.id]&&j(!0)},[]);const[c,L]=n.useState(null),T=10*1024*1024,F=a=>{a.preventDefault();const l=a.dataTransfer.files[0];b(l)&&L(l)},w=a=>{const l=a.target.files[0];b(l)&&L(l)};async function S(a){const l=t?.task_file;if(l){const i=`${h}${l}`,m=l.split("/").pop(),d=await O.get(i,{responseType:"blob"}),D=new Blob([d.data],{type:d.headers["content-type"]}),g=URL.createObjectURL(D),u=document.createElement("a");u.href=g,u.download=m,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(g)}}const b=a=>{const l=["text/plain","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/zip","application/pdf"];return a?l.includes(a.type)?a.size>T?(N.error("File size should not exceed 10 MB.",{containerId:"task",toastId:"fileSizeError"}),!1):!0:(N.info("Only .txt, .ppt, .pptx, .doc, .docx, .zip, or .pdf files are allowed.",{containerId:"task",toastId:"invalidFileType"}),!1):!1};function v(a){if(a.preventDefault(),c){const l=new FormData;l.append("file",c),l.append("task_id",t?.id),l.append("student_uid",p),E.post("/task/submitTask/",l).then(i=>{i.status===200&&(N.success("Task submission & File upload successful",{containerId:"task"}),x(!1))}).catch(i=>{console.error(i),N.error(i.response.data.message,{containerId:"task"})})}else N.error("Please select a file.",{containerId:"task",toastId:"noFileSelected"})}return e.jsx("div",{className:"z-10 fixed top-0 left-0 w-screen h-screen  backdrop-blur-[2px]  overflow-y-auto content-center",children:e.jsxs("div",{className:"justify-self-center w-11/12 xl:w-9/12 lg:w-10/12 sm:h-5/6  dark:bg-darkBg/95 bg-lightBg/95 rounded-3xl p-3 flex flex-col ",children:[e.jsxs("div",{className:"flex justify-between flex-none min-h-8",children:[e.jsx("h1",{className:"font-semibold text-2xl ml-4 wrap-text w-11/12",children:t?.title}),e.jsx("button",{className:"px-2 bg-red-600 text-darkText rounded-full hover:bg-red-700 h-9 w-9",onClick:()=>x(!1),children:"â›Œ"})]}),e.jsxs("div",{className:"flex-1 w-full flex p-3 sm:flex-row flex-col sm:h-[calc(100%-2rem)] ",children:[e.jsxs("div",{className:"sm:h-full sm:w-7/12 w-full p-3 relative sm:overflow-y-auto",children:[e.jsx("div",{className:"sm:h-2/6 h-full",children:e.jsx("img",{src:t?.task_image?`${h}${t?.task_image}`:`https://picsum.photos/seed/${t?.id}/600/200`,alt:t?.title,className:"object-cover h-full w-full rounded-lg"})}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex justify-between p-1",children:[e.jsx("h2",{className:"font-semibold text-lg",children:`Subject ${t?.subject}`}),e.jsx("div",{children:" "}),e.jsx("h2",{className:" text-md",children:`Assigned by ${t?.assignor}`})]}),e.jsx("div",{className:"h-full mt-1 ",children:e.jsx(W,{value:t?.description,modules:{toolbar:!1},readOnly:!0})})]})]}),e.jsx("div",{className:"sm:h-full sm:w-5/12 w-full dark:bg-darkHeader bg-lightHeader sm:rounded-r-2xl sm:rounded-bl-none rounded-b-2xl",children:e.jsxs("div",{className:"p-4 w-full h-full flex flex-col justify-between",children:[e.jsxs("div",{className:"font-semibold gap-2 flex flex-col",children:[e.jsxs("h3",{className:"flex justify-between",children:["Assigned on: ",e.jsx("span",{children:`${f(t?.created_date)}`})]}),e.jsxs("h3",{className:"flex justify-between",children:["Deadline: ",e.jsx("span",{children:`${f(t?.due_date)}`})]}),y&&e.jsxs("h3",{className:"flex justify-between bg-green-600 p-1 rounded-xl",children:["Submitted on: ",e.jsx("span",{children:`${f(o[t?.id].submitted_date)}`})]})]}),e.jsx("div",{className:"w-full sm:h-full flex flex-col relative ",children:y?null:e.jsxs("div",{className:"w-full h-full flex flex-col justify-between mt-20",children:[e.jsx("div",{className:"w-full max-w-md mx-auto ",children:e.jsxs("div",{onDrop:F,onDragOver:a=>a.preventDefault(),className:"border-2 border-dashed dark:border-gray-400 border-gray-500 rounded-lg p-6 flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-gray-600 dark:text-darkText text-center",children:"Drag and drop a file here, or click to upload"}),e.jsx("input",{type:"file",onChange:w,className:"hidden",accept:".txt,.ppt,.pptx,.doc,.docx,.zip,.pdf",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"mt-4 px-2 py-1 bg-blue-500 text-white rounded-xl cursor-pointer",children:c?"Replace File":"Upload File"}),c&&e.jsxs("div",{className:"mt-4 text-sm dark:text-darkText text-gray-700 break-words w-full",children:["Selected file: ",c.name," (",(c.size/1024/1024).toFixed(2)," MB)"]})]})}),e.jsx("div",{className:"flex justify-center mt-10",children:t?.task_file&&e.jsxs("button",{className:"justify-self-center font-semibold hover:font-bold text-xl px-2 py-1 bg-blue-500 text-white rounded-xl hover:bg-blue-600 mx-auto",onClick:a=>S(),children:[e.jsxs("svg",{width:"30px",height:"30px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"#ffffff",className:"inline-block",children:[e.jsx("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),e.jsx("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",e.jsx("path",{d:"M5.25589 16C3.8899 15.0291 3 13.4422 3 11.6493C3 9.20008 4.8 6.9375 7.5 6.5C8.34694 4.48637 10.3514 3 12.6893 3C15.684 3 18.1317 5.32251 18.3 8.25C19.8893 8.94488 21 10.6503 21 12.4969C21 14.0582 20.206 15.4339 19 16.2417M12 21V11M12 21L9 18M12 21L15 18",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})," "]})]})," File by Mentor"]})}),e.jsx("div",{className:"flex justify-center  w-full sm:mb-0 mb-10 sm:mt-0",children:e.jsx("button",{className:"font-semibold hover:font-bold text-xl px-2 py-1 bg-blue-500 text-white rounded-xl hover:bg-blue-600 mx-auto",onClick:v,children:"Submit"})})]})})]})})]})]})})}function q(){const{theme:t}=M(),{axiosSecure:x,standards:o,timeLimit:h,uid:f}=B(),[p,E]=n.useState([]),[y,j]=n.useState({}),[c,L]=n.useState([]),[T,F]=n.useState([]),[w,S]=n.useState({}),[b,v]=n.useState(!1);n.useEffect(()=>{const s=o.map(r=>x.get(`task/byStudent/${r}`).then(k=>k.data));Promise.all(s).then(r=>{E(r.flat())}).catch(r=>{console.log(r)})},[b]),n.useEffect(()=>{const s=o.map(r=>x.get(`task/studentGetSubmissions/${r}/${f}/`).then(k=>k.data));Promise.all(s).then(r=>{const k=r.flat();S(k.reduce((z,{task_id:I,...U})=>(z[I]=U,z),{}))}).catch(r=>{console.log(r)})},[b]);const[a,l]=n.useState([]);n.useEffect(()=>{L(p.filter(s=>new Date(s.due_date)-new Date("2024-12-12")<h&&!w[s.id])),F(p.filter(s=>new Date(s.due_date)-new Date("2024-12-12")>h&&!w[s.id])),l(p.filter(s=>w[s.id]))},[p]);const i=n.useRef(null),m=n.useRef(null),d=n.useRef(null);function D(s){i.current&&(i.current.scrollLeft-=s.movementX)}function g(s){m.current&&(m.current.scrollLeft-=s.movementX)}function u(s){d.current&&(d.current.scrollLeft-=s.movementX)}function R(s){window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",R)}function _(s){window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",_)}function $(s){window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",$)}return e.jsxs("div",{children:[e.jsx(V,{containerId:"task",position:"top-right",theme:t}),b?e.jsx(P,{info:y,setTaskViewer:v,submittedTask:w}):null,c.length>0&&e.jsxs("div",{className:"sm:p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold py-4",children:"Time Limit"}),e.jsxs("div",{className:"my-auto",children:[e.jsx("button",{onClick:()=>{i.current.scrollBy({left:-i.current.offsetWidth*.7,behavior:"smooth"})},className:"p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:e.jsx("path",{fill:t==="dark"?"#DFF2EB":"#000000",d:"M15.293 3.293 6.586 12l8.707 8.707 1.414-1.414L9.414 12l7.293-7.293-1.414-1.414z"})})}),e.jsx("button",{onClick:()=>{i.current.scrollBy({left:i.current.offsetWidth*.7,behavior:"smooth"})},className:"p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:e.jsx("path",{fill:t==="dark"?"#DFF2EB":"#000000",d:"M7.293 4.707 14.586 12l-7.293 7.293 1.414 1.414L17.414 12 8.707 3.293 7.293 4.707z"})})})]})]}),e.jsxs("div",{className:"grid grid-flow-col grid-rows-1  overflow-x-auto no-scrollbar  overflow-y-hidden",ref:i,onMouseDown:s=>{s.preventDefault(),window.addEventListener("mousemove",D),window.addEventListener("mouseup",R)},children:[c.map(s=>e.jsx("div",{className:"mr-5",children:e.jsx(C,{info:s,setTaskViewer:v,setTaskInfo:j})},s.id)),e.jsx("div",{className:"rotate-90 h-[4rem] text-center my-auto text-2xl font-semibold",children:"END"})]})]}),e.jsxs("div",{className:"sm:p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold py-4",children:"New Task"}),e.jsxs("div",{className:"my-auto",children:[e.jsx("button",{onClick:()=>{m.current.scrollBy({left:-m.current.offsetWidth*.7,behavior:"smooth"})},className:"p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:e.jsx("path",{fill:t==="dark"?"#DFF2EB":"#000000",d:"M15.293 3.293 6.586 12l8.707 8.707 1.414-1.414L9.414 12l7.293-7.293-1.414-1.414z"})})}),e.jsx("button",{onClick:()=>{m.current.scrollBy({left:m.current.offsetWidth*.7,behavior:"smooth"})},className:"p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:e.jsx("path",{fill:t==="dark"?"#DFF2EB":"#000000",d:"M7.293 4.707 14.586 12l-7.293 7.293 1.414 1.414L17.414 12 8.707 3.293 7.293 4.707z"})})})]})]}),e.jsx("div",{className:"grid grid-flow-col grid-rows-1  overflow-x-auto no-scrollbar overflow-y-hidden",ref:m,onMouseDown:s=>{s.preventDefault(),window.addEventListener("mousemove",g),window.addEventListener("mouseup",_)},children:T.length>0?e.jsxs(e.Fragment,{children:[T.map(s=>e.jsx("div",{className:"mr-5",children:e.jsx(C,{info:s,setTaskViewer:v,setTaskInfo:j})},s.id)),e.jsx("div",{className:"rotate-90 h-[4rem] text-center my-auto text-2xl font-semibold",children:"END"})]}):e.jsx("div",{className:"font-semibold text-2xl text-center my-auto",children:"No New Task"})})]}),a.length>0&&e.jsxs("div",{className:"sm:p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold py-4",children:"Completed Tasks"}),e.jsxs("div",{className:"my-auto",children:[e.jsx("button",{onClick:()=>{d.current.scrollBy({left:-d.current.offsetWidth*.7,behavior:"smooth"})},className:"p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:e.jsx("path",{fill:t==="dark"?"#DFF2EB":"#000000",d:"M15.293 3.293 6.586 12l8.707 8.707 1.414-1.414L9.414 12l7.293-7.293-1.414-1.414z"})})}),e.jsx("button",{onClick:()=>{d.current.scrollBy({left:d.current.offsetWidth*.7,behavior:"smooth"})},className:"p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:e.jsx("path",{fill:t==="dark"?"#DFF2EB":"#000000",d:"M7.293 4.707 14.586 12l-7.293 7.293 1.414 1.414L17.414 12 8.707 3.293 7.293 4.707z"})})})]})]}),e.jsxs("div",{className:"grid grid-flow-col grid-rows-1  overflow-x-auto no-scrollbar  overflow-y-hidden",ref:d,onMouseDown:s=>{s.preventDefault(),window.addEventListener("mousemove",u),window.addEventListener("mouseup",$)},children:[a.map(s=>e.jsx("div",{className:"mr-5",children:e.jsx(C,{info:s,setTaskViewer:v,setTaskInfo:j})},s.id)),e.jsx("div",{className:"rotate-90 h-[4rem] text-center my-auto text-2xl font-semibold",children:"END"})]})]})]})}export{q as default};
